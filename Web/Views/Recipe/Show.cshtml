@using Microsoft.AspNetCore.Mvc.Localization
@inject IViewLocalizer Localizer

<h1>@Localizer["Header"]</h1>
<div>
    <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
        <li class="nav-item">
            <a class="nav-link active" name="all" id="allPostsTab" data-toggle="pill" href="#allPostsContainer" role="tab" aria-controls="allPostsContainer" aria-selected="true">Все рецепты</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" name="my" id="myPostsTab" data-toggle="pill" href="#myPostsContainer" role="tab" aria-controls="myPostsContainer" aria-selected="false">Мои рецепты и подписки</a>
        </li>
    </ul>
    <div class="tab-content" id="pills-tabContent">
        <div class="tab-pane fade show active" id="allPostsContainer" role="tabpanel">
            <div id="allPosts">

            </div>
        </div>
        <div class="tab-pane fade" id="myPostsContainer" role="tabpanel">
            <div id="myPosts">

            </div>
        </div>
    </div>
</div>

@section scripts{
    <script type="text/javascript">
        window.onload = function () {
            $.ajax({
                type: 'POST',
                url: 'PartialPost',
                dataType: 'html',
                data: { 'parameter': 'all' },
                success: function (data) {
                    console.log("Get Posts");
                    $('#allPosts').append(data);
                },
                error: function (err) {
                    console.log(err);
                }
            });
        };

        function getContainer(parameter) {
            switch (parameter) {
                case 'all':
                    return $('#allPosts');
                case 'my':
                    return $('#myPosts');
            }
            console.log("WRONG PARAMETER");
        }
        $('.nav-link').on('show.bs.tab', function (e) {
            let parameter = $(this).attr('name');
            let container = getContainer(parameter);
            $.ajax({
                type: 'POST',
                url: 'PartialPost',
                dataType: 'html',
                data: { 'parameter': parameter },
                success: function (data) {
                    console.log("Get Posts");
                    container.append(data);
                },
                error: function (err) {
                    console.log(err);
                }
            });
        });

        $('.nav-link').on('hide.bs.tab', function (e) {
            let container = getContainer($(this).attr('name'));
            container.empty();
        });
    </script>
}
